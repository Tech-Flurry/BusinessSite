@page "/Blogs/Blog/{Identifier}"
@using TechFlurry.BusinessSite.Models
@using Microsoft.AspNetCore.Components.Authorization

<section id="page-title">
    <div class="container clearfix">
        <h1>Blog Single</h1>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item"><a href="#">Blog</a></li>
            <li class="breadcrumb-item active" aria-current="page">
                <_ContentLoader Model="_model" Content="x=>x.ShortTitle" />
            </li>
        </ol>
    </div>
</section>


<section id="content">
    <div class="content-wrap">
        <div class="container clearfix">

            <div class="single-post mb-0">

                <!-- Single Post
                ============================================= -->
                <div class="entry clearfix">

                    <!-- Entry Title
                    ============================================= -->
                    <div class="entry-title">
                        <h2><_ContentLoader Model="_model" Content="x=>x.Heading" /></h2>
                    </div><!-- .entry-title end -->
                    <!-- Entry Meta
                    ============================================= -->
                    <div class="entry-meta">
                        <ul>
                            <li><i class="icon-calendar3"></i> <_ContentLoader Model="_model" Content="x=>x.DatePosted.ToString(DATE_FORMAT)" /></li>
                            <li><a href="#"><i class="icon-user"></i> <_ContentLoader Model="_model" Content="x=>x.Author?.NickName" /></a></li>
                            <li><i class="icon-folder-open"></i> <a href="#"><_ContentLoader Model="_model" Content="x=>x.Category" /></a></li>
                            <li><a href="#"><i class="icon-comments"></i> <_ContentLoader Model="_model" Content="x=>x.Comments?.Count" /> Comments</a></li>
                            <li>
                                <a href="#">
                                    <AuthorizeView Policy="ContentEditor">
                                        <i class="icon-comments"></i> Edit
                                    </AuthorizeView>
                                </a>
                            </li>
                        </ul>
                    </div><!-- .entry-meta end -->
                    <!-- Entry Image
                    ============================================= -->
                    <div class="entry-image bottommargin">
                        <a href="#"><img src="@_model?.MainImage" alt="@_model?.ShortTitle"></a>
                    </div><!-- .entry-image end -->
                    <!-- Entry Content
                    ============================================= -->
                    <div class="entry-content mt-0">
                        @((MarkupString)_model?.Content)
                        <!-- Post Single - Content End -->
                        <!-- Tag Cloud
                        ============================================= -->
                        <div class="tagcloud clearfix bottommargin">
                            @foreach (var tag in _model?.Tags)
                            {
                                <a href="#">@tag</a>
                            }
                        </div><!-- .tagcloud end -->

                        <div class="clear"></div>

                        <!-- Post Single - Share
                        ============================================= -->
                        <div class="si-share border-0 d-flex justify-content-between align-items-center">
                            <span>Share this Post:</span>
                            <div>
                                <a href="#" class="social-icon si-borderless si-facebook">
                                    <i class="icon-facebook"></i>
                                    <i class="icon-facebook"></i>
                                </a>
                                <a href="#" class="social-icon si-borderless si-twitter">
                                    <i class="icon-twitter"></i>
                                    <i class="icon-twitter"></i>
                                </a>
                                <a href="#" class="social-icon si-borderless si-pinterest">
                                    <i class="icon-pinterest"></i>
                                    <i class="icon-pinterest"></i>
                                </a>
                                <a href="#" class="social-icon si-borderless si-gplus">
                                    <i class="icon-gplus"></i>
                                    <i class="icon-gplus"></i>
                                </a>
                                <a href="#" class="social-icon si-borderless si-rss">
                                    <i class="icon-rss"></i>
                                    <i class="icon-rss"></i>
                                </a>
                                <a href="#" class="social-icon si-borderless si-email3">
                                    <i class="icon-email3"></i>
                                    <i class="icon-email3"></i>
                                </a>
                            </div>
                        </div><!-- Post Single - Share End -->

                    </div>
                </div><!-- .entry end -->
                <!-- Post Author Info
                ============================================= -->
                <div class="card">
                    <div class="card-header"><strong>Posted by <a href="#"><_ContentLoader Model="_model" Content="x=>x.Author.Name" /></a></strong></div>
                    <div class="card-body">
                        <div class="author-image">
                            <img src="@_model?.Author.Picture" alt="@_model?.ShortTitle" class="rounded-circle">
                        </div>
                        <_ContentLoader Model="_model" Content="x=>x.Author.Bio" />
                    </div>
                </div><!-- Post Single - Author End -->

                <div class="line"></div>

                @if (_model is not null)
                {
                    <_RelatedBlogs Category="@_model.Category" />
                }

                <!-- Comments
                ============================================= -->
                <div id="comments" class="clearfix">

                    <h3 id="comments-title"><span>@_model?.Comments.Count</span> Comments</h3>

                    <!-- Comments List
                    ============================================= -->
                    <ol class="commentlist clearfix">
                        @foreach (var comment in _model?.Comments)
                        {
                            <li class="comment even thread-even depth-1" id="li-comment-1">
                                <div id="comment-1" class="comment-wrap clearfix">

                                    <div class="comment-meta">

                                        <div class="comment-author vcard">

                                            <span class="comment-avatar clearfix">
                                                <img alt='Image' src='@comment?.User.Picture' class='avatar avatar-60 photo avatar-default' height='60' width='60' />
                                            </span>

                                        </div>

                                    </div>

                                    <div class="comment-content clearfix">

                                        <div class="comment-author">@comment?.User.Name<span>@comment.PostedTime.ToString("dd MMM yyyy h:mm tt")</span></div>

                                        <p>@comment.Content</p>

                                    </div>

                                    <div class="clear"></div>

                                </div>
                            </li>
                        }

                    </ol>

                    <div class="clear"></div>
                    <div id="respond">
                        <h3>Leave a <span>Comment</span></h3>
                        <AuthorizeView>
                            <Authorized>
                                <form class="row" action="#" method="post" id="commentform">

                                    <div class="col-12 form-group">
                                        <label for="comment">Comment</label>
                                        <textarea name="comment" cols="58" rows="7" tabindex="4" class="sm-form-control"></textarea>
                                    </div>

                                    <div class="col-12 form-group">
                                        <button name="submit" type="submit" id="submit-button" tabindex="5" value="Submit" class="button button-3d m-0">Submit Comment</button>
                                    </div>
                                </form>

                            </Authorized>
                            <NotAuthorized>
                                <p>Please login to comment!!!</p>
                            </NotAuthorized>
                        </AuthorizeView>
                    </div>

                </div>

            </div>

        </div>
    </div>
</section>


@code {
    [Parameter]
    public string Identifier { get; set; }


    private BlogModel _model;
    const string DATE_FORMAT = "MMMM dd, yyyy";
}

@functions {
    protected async override Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        _model = new BlogModel
            {
                Author = new AuthorModel
                {
                    Bio = "Pakistani by birth, sober by face and childish by acts. Addicted to poetry and mad for traveling. Has great fondness for reading novels and loves the company of friends. I'm Sarim Chaudhary; having a handsome experience of writing blogs and articles on hot topics like politics, business, e-commerce, travelling, and DIY techniques to help elevate the living style and standards of my readers.",
                    Email = "sarimch@gmail.com",
                    Id = Guid.NewGuid(),
                    Name = "Abdul Samad Sarim Chaudhary",
                    NickName = "Sarim Ch.",
                    Picture = "https://secure.gravatar.com/avatar/de96bd4c34a0053f05df57f6ecf8127e?s=150&d=mm&r=g"
                },
                BlogType = BlogType.SinglePage,
                Category = "Demo",
                Content = @"<p>Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Cras mattis consectetur purus sit amet fermentum. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Praesent commodo cursus magna, vel scelerisque nisl consectetur et.</p>

                        <p>Nullam id dolor id nibh ultricies vehicula ut id elit. <a href=""#"">Curabitur blandit tempus porttitor</a>. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Vestibulum id ligula porta felis euismod semper. Donec id elit non mi porta gravida at eget metus. Vestibulum id ligula porta felis euismod semper.</p>

                        <blockquote><p>Vestibulum id ligula porta felis euismod semper. Sed posuere consectetur est at lobortis. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Donec ullamcorper nulla non metus auctor fringilla. Vestibulum id ligula porta felis euismod semper.</p></blockquote>

                        <p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras mattis consectetur purus sit amet fermentum. Donec id elit non mi porta gravida at eget metus.</p>

                        <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Aenean lacinia bibendum nulla sed consectetur. Cras justo odio, dapibus ac facilisis in, egestas eget quam. <a href=""#"">Nullam quis risus eget urna</a> mollis ornare vel eu leo. Integer posuere erat a ante venenatis dapibus posuere velit aliquet.</p>

                        <pre>
                        #header-inner {
                        width: 940px;
                        margin: 0 auto;
                        padding-top: 40px;
                        }</pre>

                        <p>Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Cras mattis consectetur purus sit amet fermentum. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Praesent commodo cursus magna, vel scelerisque nisl consectetur et.</p>

                        <p>Nullam id dolor id nibh ultricies vehicula ut id elit. Curabitur blandit tempus porttitor. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Vestibulum id ligula porta felis euismod semper. Donec id elit non mi porta gravida at eget metus. Vestibulum id ligula porta felis euismod semper.</p>",
                DatePosted = DateTime.Today.AddDays(-3),
                Heading = "This is a Standard post with a Preview Image",
                ShortTitle = "Blog Single",
                Identifier = "blog-single",
                MainImage = "https://www.fabglassandmirror.com/blog/wp-content/uploads/2022/05/image8-1.png",
                Tags = { "General", "Demo", "Blogs", "Articles" },
                Comments = new List<Comment> {
                    new Comment {
                        Content = "Donec sed odio dui. Nulla vitae elit libero, a pharetra augue. Nullam id dolor id nibh ultricies vehicula ut id elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet.",
                        PostedTime = DateTime.Now.AddDays(-1),
                        User = new UserModel {
                            Email = "abc@gmail.com",
                            Id = Guid.NewGuid(),
                            Name = "John Doe",
                            Picture = "https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=580&q=80",

                        }
                    },
                    new Comment {
                        Content = "Donec sed odio dui. Nulla vitae elit libero, a pharetra augue. Nullam id dolor id nibh ultricies vehicula ut id elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet.",
                        PostedTime = DateTime.Now.AddDays(-1),
                        User = new UserModel {
                            Email = "abc@gmail.com",
                            Id = Guid.NewGuid(),
                            Name = "John Doe",
                            Picture = "https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80",

                        }
                    },
                    new Comment {
                        Content = "Donec sed odio dui. Nulla vitae elit libero, a pharetra augue. Nullam id dolor id nibh ultricies vehicula ut id elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet.",
                        PostedTime = DateTime.Now.AddDays(-1),
                        User = new UserModel {
                            Email = "abc@gmail.com",
                            Id = Guid.NewGuid(),
                            Name = "John Doe",
                            Picture = "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80",

                        }
                    }
                }
            };
    }

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        await base.OnAfterRenderAsync(firstRender);
        if (firstRender)
        {

        }
    }
}
